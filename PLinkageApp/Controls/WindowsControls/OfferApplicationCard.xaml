<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="PLinkageApp.WindowsControls.OfferApplicationCard"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Name="thisControl">

    <Frame
        Padding="0"
        BackgroundColor="White"
        CornerRadius="16"
        HasShadow="True"
        VerticalOptions="Start">

        <Grid RowDefinitions="Auto, *">

            <Grid Padding="12" ColumnDefinitions="Auto,*,Auto">
                <StackLayout Orientation="Horizontal" Spacing="6">
                    <Ellipse
                        Fill="{Binding Source={x:Reference thisControl}, Path=TypeColor}"
                        HeightRequest="8"
                        WidthRequest="8" />
                    <Label
                        FontAttributes="Bold"
                        Text="{Binding Source={x:Reference thisControl}, Path=OfferApplicationType}"
                        VerticalOptions="Center" />
                </StackLayout>

                <HorizontalStackLayout
                    Grid.Column="2"
                    HorizontalOptions="End"
                    Spacing="6">

                    <Border
                        Padding="8,4"
                        BackgroundColor="#FEF08A"
                        IsVisible="{Binding Source={x:Reference thisControl}, Path=IsNegotiating}"
                        StrokeThickness="0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20" />
                        </Border.StrokeShape>
                        <Label
                            FontAttributes="Bold"
                            FontSize="12"
                            Text="Negotiating"
                            TextColor="#713F12"
                            VerticalOptions="Center" />
                    </Border>

                    <Border
                        Padding="8,4"
                        BackgroundColor="{Binding Source={x:Reference thisControl}, Path=StatusBackgroundColor}"
                        StrokeThickness="0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20" />
                        </Border.StrokeShape>
                        <Label
                            FontAttributes="Bold"
                            FontSize="12"
                            Text="{Binding Source={x:Reference thisControl}, Path=OfferApplicationStatus}"
                            TextColor="{Binding Source={x:Reference thisControl}, Path=StatusTextColor}"
                            VerticalOptions="Center" />
                    </Border>
                </HorizontalStackLayout>
            </Grid>

            <VerticalStackLayout
                Grid.Row="1"
                Padding="12"
                Spacing="10">

                <Label
                    FontAttributes="Bold"
                    FontSize="20"
                    Text="{Binding Source={x:Reference thisControl}, Path=ProjectName}"
                    TextColor="#2196F3"
                    TextDecorations="Underline">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding Source={x:Reference thisControl}, Path=ViewProjectCommand}" CommandParameter="{Binding Source={x:Reference thisControl}, Path=CommandParameter}" />
                    </Label.GestureRecognizers>
                </Label>

                <StackLayout Orientation="Horizontal" Spacing="6">
                    <Image
                        HeightRequest="16"
                        Source="chatperson.png"
                        WidthRequest="16" />
                    <Label
                        Text="{Binding Source={x:Reference thisControl}, Path=FormattedConcernedName}"
                        TextColor="#2196F3"
                        TextDecorations="Underline">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding Source={x:Reference thisControl}, Path=ViewConcernedCommand}" CommandParameter="{Binding Source={x:Reference thisControl}, Path=CommandParameter}" />
                        </Label.GestureRecognizers>
                    </Label>
                </StackLayout>

                <Grid ColumnDefinitions="*,*" RowDefinitions="Auto">
                    <VerticalStackLayout>
                        <Label FontAttributes="Bold" Text="Rate Offered:" />
                        <Label Text="{Binding Source={x:Reference thisControl}, Path=FormattedRate}" />
                    </VerticalStackLayout>
                    <VerticalStackLayout Grid.Column="1">
                        <Label FontAttributes="Bold" Text="Timeframe Offered:" />
                        <Label Text="{Binding Source={x:Reference thisControl}, Path=FormattedTimeFrame}" />
                    </VerticalStackLayout>
                </Grid>

                <HorizontalStackLayout
                    HorizontalOptions="Center"
                    IsVisible="{Binding Source={x:Reference thisControl}, Path=AwaitingResponse}"
                    Spacing="10">
                    <Button
                        BackgroundColor="#7C4DFF"
                        Command="{Binding Source={x:Reference thisControl}, Path=AcceptCommand}"
                        CommandParameter="{Binding Source={x:Reference thisControl}, Path=CommandParameter}"
                        HeightRequest="35"
                        Text="Accept"
                        TextColor="White"
                        WidthRequest="80" />
                    <Button
                        BackgroundColor="Transparent"
                        BorderColor="#7C4DFF"
                        BorderWidth="1"
                        Command="{Binding Source={x:Reference thisControl}, Path=DeclineCommand}"
                        CommandParameter="{Binding Source={x:Reference thisControl}, Path=CommandParameter}"
                        HeightRequest="35"
                        Text="Decline"
                        TextColor="#7C4DFF"
                        WidthRequest="80" />
                    <Button
                        BackgroundColor="Transparent"
                        BorderColor="#F97316"
                        BorderWidth="1"
                        Command="{Binding Source={x:Reference thisControl}, Path=NegotiateCommand}"
                        CommandParameter="{Binding Source={x:Reference thisControl}, Path=CommandParameter}"
                        HeightRequest="35"
                        IsVisible="{Binding Source={x:Reference thisControl}, Path=IsNegotiable}"
                        Text="Negotiate"
                        TextColor="#F97316"
                        WidthRequest="95" />
                </HorizontalStackLayout>

            </VerticalStackLayout>
        </Grid>
    </Frame>
</ContentView>