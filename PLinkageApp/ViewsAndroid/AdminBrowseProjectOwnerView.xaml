<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="PLinkageApp.ViewsAndroid.AdminBrowseProjectOwnerView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:controls="clr-namespace:PLinkageApp.AndroidControls"
    xmlns:viewmodels="clr-namespace:PLinkageApp"
    Title="AdminBrowseProjectOwnerView"
    x:DataType="viewmodels:AdminBrowseProjectOwnerViewModelTemp"
    Shell.NavBarIsVisible="False">

    <Grid RowDefinitions="Auto, Auto, *">

        <FlexLayout
            Grid.Row="0"
            Padding="10"
            AlignItems="Center"
            BackgroundColor="#F1F0FC"
            Direction="Column"
            JustifyContent="Start">
            <Image
                HeightRequest="90"
                Source="plinkagenotext.svg"
                WidthRequest="90" />
            <Label
                FontAttributes="Bold"
                FontSize="27"
                Text="Browse Project Owner"
                TextColor="#212121" />

            <controls:LabeledPicker
                Margin="0,3,0,0"
                IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBooleanConverter}}"
                ItemSource="{Binding CategoryOptions}"
                PlaceholderText="Filter By"
                SelectedItem="{Binding CategorySelection}"
                TitleText="By Location" />

            <controls:LabeledPicker
                IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBooleanConverter}}"
                IsVisible="{Binding CategorySelection, Converter={StaticResource SortToVisibilityConverter}}"
                ItemSource="{Binding LocationOptions}"
                PlaceholderText="Filter By"
                SelectedItem="{Binding LocationSelection}"
                TitleText="Location Selection" />

            <controls:LabeledPicker
                IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBooleanConverter}}"
                ItemSource="{Binding StatusOptions}"
                PlaceholderText="Filter By"
                SelectedItem="{Binding StatusSelection}"
                TitleText="By User Status" />
        </FlexLayout>

        <controls:SearchInput
            Grid.Row="1"
            Margin="0,10,0,0"
            ControlWidth="280"
            HorizontalOptions="Center"
            IconSource="search.svg"
            SearchPlaceholder="Narrow Results By Name..."
            SearchQuery="{Binding SearchQuery}" />

        <RefreshView
            Grid.Row="2"
            Command="{Binding RefreshCommand}"
            IsRefreshing="{Binding IsBusy, Mode=OneWay}">

            <CollectionView
                Margin="0,10,0,0"
                ItemsSource="{Binding ProjectOwnerCards}"
                SelectionMode="None">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <controls:ProjectOwnerCard
                            Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:AdminBrowseProjectOwnerViewModelTemp}}, Path=ViewProjectOwnerCommand}"
                            CommandParameter="{Binding .}"
                            ProjectCount="{Binding ProjectCount}"
                            UserName="{Binding UserName}"
                            UserStatus="{Binding UserStatus}" />
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout ItemSpacing="5" Orientation="Vertical" />
                </CollectionView.ItemsLayout>
            </CollectionView>
        </RefreshView>

    </Grid>
</ContentPage>