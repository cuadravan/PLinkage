<?xml version="1.0" encoding="utf-8" ?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
          xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
          xmlns:viewmodels="clr-namespace:PLinkage.ViewModels"
          x:Class="PLinkage.Views.ProjectOwnerOffersAndApplicationsView"
          Title="Offers and Applications">

    <ScrollView Padding="20" HorizontalScrollBarVisibility="Always">
        <!-- Use a Grid with 4 columns -->
        <Grid ColumnSpacing="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- SECTION 1: Sent Offers (Pending) -->
            <VerticalStackLayout Grid.Column="0" Spacing="10">
                <Label Text="Sent Offers (Pending)" FontAttributes="Bold" FontSize="18" HorizontalOptions="Center" />
                <CollectionView ItemsSource="{Binding SentOffersPending}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border Background="White" Stroke="#D9D9D9" StrokeThickness="1"
                                    StrokeShape="RoundRectangle 12" Padding="14" Margin="0,0,0,10">
                                <Grid ColumnDefinitions="3*,3*,2*" VerticalOptions="Center">
                                    <VerticalStackLayout>
                                        <Label Text="ðŸ”µ Offer" FontSize="10" TextColor="#2196F3" />
                                        <Label Text="{Binding ProjectName}" FontAttributes="Bold">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer
                                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=ViewProjectCommand}" 
                                                    CommandParameter="{Binding .}"/>
                                            </Label.GestureRecognizers>
                                        </Label>

                                        <Label Text="Rate Offered:" FontAttributes="Bold" FontSize="12" TextColor="Black" />
                                        <Label Text="{Binding FormattedRate}" FontSize="12" TextColor="Black" />

                                        <Label Text="Timeframe Offered:" FontAttributes="Bold" FontSize="12" TextColor="Black" Margin="0,8,0,0" />
                                        <Label Text="{Binding FormattedTimeFrame}" FontSize="12" TextColor="Black" />
                                    </VerticalStackLayout>

                                    <VerticalStackLayout Grid.Column="1" HorizontalOptions="Center">
                                        <Label Text="{Binding ReceiverName, StringFormat='Sent to: {0}'}" FontAttributes="Bold">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer
                                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=ViewReceiverCommand}" 
                                                    CommandParameter="{Binding .}"/>
                                            </Label.GestureRecognizers>
                                        </Label>
                                    </VerticalStackLayout>

                                    <Label Grid.Column="2" Text="Pending" TextColor="Gray" VerticalOptions="Center" FontAttributes="Bold" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>

            <!-- SECTION 2: Received Applications (Pending) -->
            <VerticalStackLayout Grid.Column="1" Spacing="10">
                <Label Text="Received Applications (Pending)" FontAttributes="Bold" FontSize="18" HorizontalOptions="Center" />
                <CollectionView ItemsSource="{Binding ReceivedApplicationsPending}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border Background="White" Stroke="#D9D9D9" StrokeThickness="1"
                                    StrokeShape="RoundRectangle 12" Padding="14" Margin="0,0,0,8">
                                <Grid ColumnDefinitions="3*,3*,2*" VerticalOptions="Center">
                                    <VerticalStackLayout>
                                        <Label Text="ðŸŸ  Application" FontSize="10" TextColor="#FF9800" />
                                        <Label Text="{Binding ProjectName}" FontAttributes="Bold">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer
                                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=ViewProjectCommand}" 
                                                    CommandParameter="{Binding .}"/>
                                            </Label.GestureRecognizers>
                                        </Label>

                                        <Label Text="Rate Offered:" FontAttributes="Bold" FontSize="12" TextColor="Black" />
                                        <Label Text="{Binding FormattedRate}" FontSize="12" TextColor="Black" />

                                        <Label Text="Timeframe Offered:" FontAttributes="Bold" FontSize="12" TextColor="Black" Margin="0,8,0,0" />
                                        <Label Text="{Binding FormattedTimeFrame}" FontSize="12" TextColor="Black" />
                                    </VerticalStackLayout>

                                    <VerticalStackLayout Grid.Column="1" HorizontalOptions="Center">
                                        <Label Text="{Binding SenderName, StringFormat='Received from: {0}'}" FontAttributes="Bold">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer
                                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=ViewSenderCommand}" 
                                                    CommandParameter="{Binding .}"/>
                                            </Label.GestureRecognizers>
                                        </Label>
                                    </VerticalStackLayout>

                                    <VerticalStackLayout Grid.Column="2" Spacing="8" HorizontalOptions="End" VerticalOptions="Center">
                                        <Button Text="âœ“"
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=ApproveApplicationCommand}"
                                                CommandParameter="{Binding .}"
                                                BackgroundColor="#C8E6C9" TextColor="Black" CornerRadius="10" />
                                        <Button Text="âœ•"
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=RejectApplicationCommand}"
                                                CommandParameter="{Binding .}"
                                                BackgroundColor="#FFCDD2" TextColor="Black" CornerRadius="10" />
                                    </VerticalStackLayout>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>

            <!-- SECTION 3: Sent Offers (History) -->
            <VerticalStackLayout Grid.Column="2" Spacing="10">
                <Label Text="Sent Offers (History)" FontAttributes="Bold" FontSize="18" HorizontalOptions="Center" />
                <CollectionView ItemsSource="{Binding SentOffersHistory}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border Background="LightGray" Stroke="#D9D9D9" StrokeThickness="1"
                                    StrokeShape="RoundRectangle 12" Padding="14" Margin="0,0,0,10">
                                <Grid ColumnDefinitions="3*,3*,2*" VerticalOptions="Center">
                                    <VerticalStackLayout>
                                        <Label Text="ðŸ”µ Offer" FontSize="10" TextColor="#2196F3" />
                                        <Label Text="{Binding ProjectName}" FontAttributes="Bold">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer
                                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=ViewProjectCommand}" 
                                                    CommandParameter="{Binding .}"/>
                                            </Label.GestureRecognizers>
                                        </Label>

                                        <Label Text="Rate Offered:" FontAttributes="Bold" FontSize="12" TextColor="Black" />
                                        <Label Text="{Binding FormattedRate}" FontSize="12" TextColor="Black" />

                                        <Label Text="Timeframe Offered:" FontAttributes="Bold" FontSize="12" TextColor="Black" Margin="0,8,0,0" />
                                        <Label Text="{Binding FormattedTimeFrame}" FontSize="12" TextColor="Black" />
                                    </VerticalStackLayout>

                                    <VerticalStackLayout Grid.Column="1" HorizontalOptions="Center">
                                        <Label Text="{Binding ReceiverName, StringFormat='Sent to: {0}'}" FontAttributes="Bold">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer
                                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=ViewReceiverCommand}" 
                                                    CommandParameter="{Binding .}"/>
                                            </Label.GestureRecognizers>
                                        </Label>
                                    </VerticalStackLayout>

                                    <Label Grid.Column="2"
                                           Text="{Binding OfferApplicationStatus}"
                                           TextColor="Gray"
                                           FontAttributes="Bold"
                                           VerticalOptions="Center" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>

            <!-- SECTION 4: Received Applications (History) -->
            <VerticalStackLayout Grid.Column="3" Spacing="10">
                <Label Text="Received Applications (History)" FontAttributes="Bold" FontSize="18" HorizontalOptions="Center" />
                <CollectionView ItemsSource="{Binding ReceivedApplicationsHistory}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border Background="LightGray" Stroke="#D9D9D9" StrokeThickness="1"
                                    StrokeShape="RoundRectangle 12" Padding="14" Margin="0,0,0,10">
                                <Grid ColumnDefinitions="3*,3*,2*" VerticalOptions="Center">
                                    <VerticalStackLayout>
                                        <Label Text="ðŸŸ  Application" FontSize="10" TextColor="#FF9800" />
                                        <Label Text="{Binding ProjectName}" FontAttributes="Bold">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer
                                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=ViewProjectCommand}" 
                                                    CommandParameter="{Binding .}"/>
                                            </Label.GestureRecognizers>
                                        </Label>

                                        <Label Text="Rate Offered:" FontAttributes="Bold" FontSize="12" TextColor="Black" />
                                        <Label Text="{Binding FormattedRate}" FontSize="12" TextColor="Black" />

                                        <Label Text="Timeframe Offered:" FontAttributes="Bold" FontSize="12" TextColor="Black" Margin="0,8,0,0" />
                                        <Label Text="{Binding FormattedTimeFrame}" FontSize="12" TextColor="Black" />
                                    </VerticalStackLayout>

                                    <VerticalStackLayout Grid.Column="1" HorizontalOptions="Center">
                                        <Label Text="{Binding SenderName, StringFormat='Received from: {0}'}" FontAttributes="Bold">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer
                                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ProjectOwnerApplicationOfferViewModel}}, Path=ViewSenderCommand}" 
                                                    CommandParameter="{Binding .}"/>
                                            </Label.GestureRecognizers>
                                        </Label>
                                    </VerticalStackLayout>

                                    <Label Grid.Column="2"
                                           Text="{Binding OfferApplicationStatus}"
                                           TextColor="Gray"
                                           FontAttributes="Bold"
                                           VerticalOptions="Center" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Grid>
    </ScrollView>
</ContentPage>